(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{370:function(e,a,t){"use strict";t.r(a);var s=t(42),i=Object(s.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"examples"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#examples"}},[e._v("#")]),e._v(" Examples")]),e._v(" "),t("h2",{attrs:{id:"general-configuration"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#general-configuration"}},[e._v("#")]),e._v(" General configuration")]),e._v(" "),t("h2",{attrs:{id:"common-jobs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#common-jobs"}},[e._v("#")]),e._v(" Common jobs")]),e._v(" "),t("h2",{attrs:{id:"windows"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#windows"}},[e._v("#")]),e._v(" Windows")]),e._v(" "),t("h2",{attrs:{id:"indexation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#indexation"}},[e._v("#")]),e._v(" Indexation")]),e._v(" "),t("p",[e._v("RVT2 provides a set of jobs designated to create "),t("em",[e._v("json")]),e._v(" documents suitable to be indexed at an Elastic server.")]),e._v(" "),t("p",[e._v("The indexing process to ElasticSearch with RVT2 is generally divided in two steps:")]),e._v(" "),t("ul",[t("li",[e._v("Generate, from any kind of data (csv files, parsed directories, artifacts results, ...), a resulting "),t("em",[e._v("json")]),e._v(" document with a format suitable to be indexed at ElasticSearch.")]),e._v(" "),t("li",[e._v("Save or update the previous document to ElasticSearch")])]),e._v(" "),t("h3",{attrs:{id:"getting-files-metadata-inforamtion-with-tika"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#getting-files-metadata-inforamtion-with-tika"}},[e._v("#")]),e._v(" Getting files metadata inforamtion with Tika")]),e._v(" "),t("p",[e._v("As stated in section "),t("a",{attrs:{href:"https://incidedigital.github.io/rvt2-docs/rvt2/configure.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Configuration and Running"),t("OutboundLink")],1),e._v(", if you use the Tika module, you must run Tika in server mode by running run.sh inside the $RVT2_HOME/external_tools/tika directory.")]),e._v(" "),t("ul",[t("li",[e._v("Parse all the files in a directory (and subdirectories). Set the index_name to a custom one. Output results will be found at "),t("code",[e._v("MORGUE/CASENAME/SOURCE/output/indexer/SOURCE.json")]),e._v(".")])]),e._v(" "),t("p",[t("code",[e._v('rvt2 -j indexer.directory DIRECTORY_TO_BE_PARSED --params name="my_index"')])]),e._v(" "),t("ul",[t("li",[e._v("Parse only some categories of files whithin a certain directory and set the output filename. This is useful when the analyst is interested only in some kind of files, and reduces the number of files parsed significantly. Predefined categories can be found in "),t("code",[e._v("conf/file_categories.cfg")]),e._v(" and include "),t("em",[e._v("office, executable, compressed, plain, audio, video, image, email, crypto, geographic")]),e._v(" and "),t("em",[e._v("database")]),e._v(".")])]),e._v(" "),t("p",[t("code",[e._v('rvt2 -j indexer.directory DIRECTORY_TO_BE_PARSED --params filter="email,office" outfile="/morgue/mycase/mysource/data_to_be_indexed.json"')])]),e._v(" "),t("h3",{attrs:{id:"saving-results-to-an-instance-of-elasticsearch"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#saving-results-to-an-instance-of-elasticsearch"}},[e._v("#")]),e._v(" Saving results to an instance of ElasticSearch.")]),e._v(" "),t("p",[e._v("Before using any of these jobs it is advisable to configure the ElasticSearch server and credentials that are going to be used. These parameters are defined in the "),t("code",[e._v("indexer")]),e._v(" configuration section:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("[indexer]\nes_hosts: http://localhost:9200\nes_username:\nes_password:\n")])])]),t("p",[e._v("They can be set by creating a new configuration file (see section "),t("a",{attrs:{href:"https://incidedigital.github.io/rvt2-docs/rvt2/configure.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Configuration and Running"),t("OutboundLink")],1),e._v(") or by invoking any job with additional global parameters:")]),e._v(" "),t("p",[t("code",[e._v("rvt2 -j INDEX_JOB --globals indexer:es_hosts=ELASTIC_SERVER_URL --globals indexer:es_username=USERNAME --globals indexer:es_password=PASSWORD")])]),e._v(" "),t("p",[e._v("Whichever the origin of the json file previously generated, "),t("code",[e._v("indexer.save")]),e._v(" job should be used to actually save and index those results.")]),e._v(" "),t("ul",[t("li",[e._v("Save a previously indexed database in an ElasticSearch server")])]),e._v(" "),t("p",[t("code",[e._v("rvt2 -j indexer.save my_indexed_db.json")])]),e._v(" "),t("ul",[t("li",[e._v("Save file to ElasticSearch with a custom mapping")])]),e._v(" "),t("p",[t("code",[e._v("rvt2 -j indexer.save my_indexed_db.json --params mapping=/home/myuser/mymapping.json")])]),e._v(" "),t("h3",{attrs:{id:"parsing-mailbox"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#parsing-mailbox"}},[e._v("#")]),e._v(" Parsing mailbox")]),e._v(" "),t("p",[e._v("Thanks to "),t("code",[e._v("pffexport")]),e._v(" it is possible to parse mailbox from standard formats such as "),t("code",[e._v("pst")]),e._v(", "),t("code",[e._v("ost")]),e._v(" or "),t("code",[e._v("nst")]),e._v(". Then, results can be indexed for analysis.")]),e._v(" "),t("ul",[t("li",[e._v("Parse and index all mailboxes ("),t("em",[e._v("pst, ost, nst")]),e._v(") from a mounted source:")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("rvt2 -j indexer.mails\nrvt2 -j indexer.save /morgue/mycase/mysource/output/mail/pstfiles.csv\n")])])]),t("p",[e._v(":::info\nIf you only need to parse some of the pst files inside a mounted source, it is recommended to create a new source containing only links to those files, and then run "),t("code",[e._v("indexer.mails")]),e._v(" on that new source.\n:::")]),e._v(" "),t("h3",{attrs:{id:"converting-data-to-elasticsearch-json-formats"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#converting-data-to-elasticsearch-json-formats"}},[e._v("#")]),e._v(" Converting data to ElasticSearch json formats")]),e._v(" "),t("p",[e._v("There's a few jobs available to transform common data file formats to a json structure as ElasticSearch demands in order to be indexed.")]),e._v(" "),t("ul",[t("li",[e._v("Convert and index a CSV file with custom index name")])]),e._v(" "),t("p",[t("code",[e._v('rvt2 -j indexer.convert_csv myfile.csv --params index_name="mydata" outfile="/morgue/mycase/mysource/mydata.json"')])]),e._v(" "),t("h3",{attrs:{id:"blind-searches"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#blind-searches"}},[e._v("#")]),e._v(" Blind Searches")]),e._v(" "),t("ul",[t("li",[e._v("Search for keywords on a parsed "),t("em",[e._v("json")]),e._v(" file. Kw must be written in a file, one for each line. Resulting output file will contain a subselection of matching entries from the original file.")])]),e._v(" "),t("p",[t("code",[e._v('rvt2 -j indexer.blind_searches JSON_FILE.json --params keyword_file="PATH_TO_KW_FILE" outfile="results.json"')])]),e._v(" "),t("ul",[t("li",[e._v("Query Elastic indexes, tag matches and export results.")])]),e._v(" "),t("p",[t("code",[e._v('rvt2 -j indexer.tag_and_export --params index_name="*-myindexes" query=\'"term1" AND *term2*\' tag="CUSTOM_TAG"')])]),e._v(" "),t("p",[e._v("Original index will be updated with tags inserted to matching documents. In addition, the generated json output, by default at "),t("code",[e._v("output/indexer/exported.json")]),e._v(", containing only matching documents, can be indexed elsewhere using "),t("code",[e._v("indexer.save")]),e._v(".")]),e._v(" "),t("h3",{attrs:{id:"creating-a-timeline-of-events-from-different-artifacts"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#creating-a-timeline-of-events-from-different-artifacts"}},[e._v("#")]),e._v(" Creating a timeline of events from different artifacts")]),e._v(" "),t("p",[e._v("Currently, many parsed results from various artifacts (specially those coming from Windows partitions), can be adapted to merge in a single index following "),t("a",{attrs:{href:"https://www.elastic.co/guide/en/ecs/current/index.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Elastic Common Schema"),t("OutboundLink")],1),e._v(" mapping. This new timeline of any timestamped event extracted from a source may prove a great resource in any investigation.")]),e._v(" "),t("p",[e._v(":::info\nAny artifacts must had been parsed before. This job assumes the generated output is located at default locations when searching for the data to index.\n:::")]),e._v(" "),t("ul",[t("li",[e._v("Index all available artifacts creating an ECS timeline")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("rvt2 -j events.all\nrvt2 -j events.save\n")])])]),t("h2",{attrs:{id:"do-not-use-a-general-directory-structure"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#do-not-use-a-general-directory-structure"}},[e._v("#")]),e._v(" Do not use a general directory structure")]),e._v(" "),t("p",[e._v("The default configuration uses the folder structure introduced in this document.\nThis structure is useful in a multiuser environment because you know where you\nare going to find images and output files.")]),e._v(" "),t("p",[e._v("Nevertheless, sometimes you need a fast analyze on a directory.\nFor example, in a directory there is a file "),t("code",[e._v("myiphone.zip")]),e._v(" which includes the\nbackup of an iPhone. In this case, you can run on the same directory:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("rvt2 --source myiphone --globals imagedir=$(pwd) --globals casedir=$(pwd) -j ios.unback -- myiphone.zip\n")])])]),t("p",[e._v("That is: define imagedir and casedir as current directory, unback and analyze\nin directory "),t("code",[e._v("myiphone")]),e._v(" (source name) the file "),t("code",[e._v("myiphone.zip")]),e._v(".")]),e._v(" "),t("p",[t("code",[e._v("--globals")]),e._v(" overwrite a variable in all configuration files. Its syntax is\n"),t("code",[e._v("[sectionname:]varname=value")]),e._v(".  If "),t("code",[e._v("sectionname")]),e._v(" is not provided, "),t("code",[e._v("DEFAULT")]),e._v(" is\nused.")])])}),[],!1,null,null,null);a.default=i.exports}}]);