(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{385:function(e,t,a){"use strict";a.r(t);var s=a(42),i=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"examples"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#examples"}},[e._v("#")]),e._v(" Examples")]),e._v(" "),a("h2",{attrs:{id:"general-configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#general-configuration"}},[e._v("#")]),e._v(" General configuration")]),e._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),a("p",[e._v("Many of the examples in next sections will presume parameters such as "),a("code",[e._v("morgue")]),e._v(", "),a("code",[e._v("casename")]),e._v(" or even "),a("code",[e._v("source")]),e._v(" are already defined in local configuration, to simplify RVT2 commands:")]),e._v(" "),a("p",[e._v("The standard job execution in RVT2:\n"),a("code",[e._v("rvt2 --morgue MORGUE --casename CASENAME --source SOURCE -j JOB")]),e._v("\nwill be then simplified to:\n"),a("code",[e._v("rvt2 -j JOB")])])]),e._v(" "),a("h3",{attrs:{id:"not-using-a-general-directory-structure"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#not-using-a-general-directory-structure"}},[e._v("#")]),e._v(" Not using a general directory structure")]),e._v(" "),a("p",[e._v("The default configuration uses the folder structure introduced in this document. This structure is useful in a multiuser environment because you know where you are going to find images and output files.")]),e._v(" "),a("p",[e._v("Nevertheless, sometimes you need a fast analyze on a directory.\nFor example, consider a directory where there is a file "),a("code",[e._v("myiphone.zip")]),e._v(" containing the an iPhone's backup. In this case, you can run on the same directory:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("rvt2 --source myiphone --globals imagedir=$(pwd) --globals casedir=$(pwd) -j ios.unback -- myiphone.zip\n")])])]),a("p",[e._v("That is: define imagedir and casedir as current directory, unback and analyze\nin directory "),a("code",[e._v("myiphone")]),e._v(" (source name) the file "),a("code",[e._v("myiphone.zip")]),e._v(".")]),e._v(" "),a("p",[a("code",[e._v("--globals")]),e._v(" overwrite a variable in all configuration files. Its syntax is\n"),a("code",[e._v("[sectionname:]varname=value")]),e._v(".  If "),a("code",[e._v("sectionname")]),e._v(" is not provided, "),a("code",[e._v("DEFAULT")]),e._v(" is used.")]),e._v(" "),a("h2",{attrs:{id:"common-jobs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#common-jobs"}},[e._v("#")]),e._v(" Common jobs")]),e._v(" "),a("h3",{attrs:{id:"mounting-disks-or-forensic-images"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mounting-disks-or-forensic-images"}},[e._v("#")]),e._v(" Mounting disks or forensic images")]),e._v(" "),a("ul",[a("li",[e._v("Mount all partitions in an image:")])]),e._v(" "),a("p",[e._v("Next extensions are currently mountable: 001, dd, raw, aff, aff4, vmdx (experimental) and zip. Unless an specific path to an image file is provided as an argument, RVT2 will mount the first file matching the name "),a("code",[e._v("mysource.extension")]),e._v(" under "),a("code",[e._v("IMAGEDIR/CASE/")]),e._v(".")]),e._v(" "),a("p",[a("code",[e._v("rvt2 --source 01 -j mount /path/to/image.dd")])]),e._v(" "),a("ul",[a("li",[e._v("Mount an image with a bitlocker partition:")])]),e._v(" "),a("p",[a("code",[e._v('rvt2 --source 01 -j mount --params recovery_keys="0000-1111-...."')])]),e._v(" "),a("ul",[a("li",[e._v("Mount Volume Shadow Snapshots (VSS) from a Windows partition")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 --source 01 -j mount --params vss=True")])]),e._v(" "),a("p",[e._v("See section "),a("code",[e._v("Volume Shadow Snapshots")]),e._v(" in the present document for more information about parsing VSS partitions.")]),e._v(" "),a("ul",[a("li",[e._v("Unmount all partitions of a disk image")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 --source 01 -j umount")])]),e._v(" "),a("ul",[a("li",[e._v("Get basic disk information, such as partitions and sizes")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 --source 01 -j characterize")])]),e._v(" "),a("h3",{attrs:{id:"file-system-timeline"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#file-system-timeline"}},[e._v("#")]),e._v(" File System Timeline")]),e._v(" "),a("ul",[a("li",[e._v("Generate timeline from disk image")])]),e._v(" "),a("p",[e._v("Given an image file, and regardless of the operation system installed on disk partitions, to generate a filesystem timeline:")]),e._v(" "),a("p",[a("code",[e._v("rvt2 --source 01 -j fs_timeline")])]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),a("p",[e._v("Three files are generated with timeline parsing:")]),e._v(" "),a("ul",[a("li",[e._v("The BODY file: for each file in the source, a line including all its timestamps")]),e._v(" "),a("li",[e._v('The timeline file: actions "macb" on all files in the source, ordered by date')]),e._v(" "),a("li",[e._v("Summary: Count of files grouped by time_range")])])]),e._v(" "),a("ul",[a("li",[e._v("Generate timeline from MFT")])]),e._v(" "),a("p",[e._v("In case you only dispose of an MFT file (NTFS filesystem), and no complete disk image, timeline can be generated with:")]),e._v(" "),a("p",[a("code",[e._v("rvt2 --source 01 -j mft_timeline /path/to/$MFT")])]),e._v(" "),a("p",[e._v("You can choose which command to use to parse MFT on "),a("code",[e._v("mft_timeline")]),e._v(" by setting parameter "),a("code",[e._v("cmd")]),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"browsers-navigation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#browsers-navigation"}},[e._v("#")]),e._v(" Browsers navigation")]),e._v(" "),a("ul",[a("li",[e._v("Parse history, downloads and cookies from most used browsers (Chrome, Firefox, Safari, Edge, InternetExplorer) on a mounted disk.")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 --source 01 -j browsers")])]),e._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),a("p",[e._v("This job will search for any known browser db file on disk. You must execute "),a("code",[e._v("allocfiles")]),e._v(" job at some point before running "),a("code",[e._v("browsers")]),e._v(".")])]),e._v(" "),a("h3",{attrs:{id:"communication-apps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#communication-apps"}},[e._v("#")]),e._v(" Communication apps")]),e._v(" "),a("ul",[a("li",[e._v("Parse Skype contacts, messages and calls")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 --source 01 -j skype")])]),e._v(" "),a("ul",[a("li",[e._v("Parse Microsoft Teams contacts, messages and calls")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 --source 01 -j teams")])]),e._v(" "),a("h3",{attrs:{id:"searching-strings"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#searching-strings"}},[e._v("#")]),e._v(" Searching Strings")]),e._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),a("p",[e._v("All jobs searching strings must traverse all disk space and therefore they tend to be VERY SLOW to execute. Be aware that large processing times are expected.")])]),e._v(" "),a("ul",[a("li",[e._v("Search defined keywords over all strings of printable characters (ascii and unicode) from disk data.")])]),e._v(" "),a("p",[e._v("First of all, strings must be generated:")]),e._v(" "),a("p",[a("code",[e._v("rvt2 --source 01 -j strings")])]),e._v(" "),a("p",[e._v("Create a new file containing all keywords to search. Each line must follow the format "),a("code",[e._v("LABEL:::REGEX")]),e._v(" (REGEX can be ignored). For example:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("myfirstkeyword\nmysecondkeyword:::[Mm]y.econd{1,2}k?e?y?word\n")])])]),a("p",[e._v("Then, generate, run the search for this keywords:")]),e._v(" "),a("p",[a("code",[e._v("rvt2 -j search_strings path/to/keyword_file")])]),e._v(" "),a("p",[e._v("Results are presented in different formats for analysis. A single pdf is generated for each keyword, containing all disk blocks where it has been found.")]),e._v(" "),a("ul",[a("li",[e._v("Search specific keyword patterns, such as email accounts or bank accounts")])]),e._v(" "),a("p",[e._v("Assuming "),a("code",[e._v("strings")]),e._v(" job has already been executed:")]),e._v(" "),a("p",[a("code",[e._v("rvt2 -j search_email")]),e._v(" "),a("code",[e._v("rvt2 -j search_accounts")])]),e._v(" "),a("h2",{attrs:{id:"windows"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#windows"}},[e._v("#")]),e._v(" Windows")]),e._v(" "),a("p",[e._v("Most of Windows jobs share at least the same basic parameters:")]),e._v(" "),a("ul",[a("li",[e._v("path: Path to artifact file or directory containing artifact files. Default configuration would search on typical locations starting at a Windows partition root directory, on "),a("code",[e._v("MORGUE/CASE/SOURCE/mnt/p0x/")])]),e._v(" "),a("li",[e._v("outdir/outfile: Path to directory or file where generated output will be saved")]),e._v(" "),a("li",[e._v("volume_id: Volume identifier, such as partition number (Ex: p03). This parameter may be used to classify output from diferent input directories.")])]),e._v(" "),a("p",[e._v("Examples:")]),e._v(" "),a("ul",[a("li",[e._v("Provide a path to a custom folder containing artifacts. This may be useful when only certain artifacts have been gathered, and a complete disk image is not available:")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 --source 01 -j windows.JOB path/to/artifact_dir")])]),e._v(" "),a("ul",[a("li",[e._v("Save the results of any parsing job to a custom directory")])]),e._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),a("p",[e._v("Some RVT2 jobs rely on results from other jobs previously executed. These new jobs will search by default on expected locations for the output of the previous jobs. When setting a different, non default "),a("code",[e._v("outdir")]),e._v(", be aware to provide this directory as input to the new related jobs.")]),e._v(" "),a("p",[e._v("As a general rule, it's not advisable to change "),a("code",[e._v("outdir")]),e._v(" or "),a("code",[e._v("outfile")]),e._v(" parameter. Jobs description include the default output directory location, so it's always possible to know where to search for the generated results.")])]),e._v(" "),a("p",[a("code",[e._v('rvt2 --source 01 -j windows.JOB --params outdir="path/to/custom_dir"')])]),e._v(" "),a("ul",[a("li",[e._v("Separate results from different inputs using "),a("code",[e._v("volume_id")]),e._v(". This applies when more than a single artifact of the same kind should be parsed for the same source. For example, when having regular Windows event logs and a new set of them coming from a backup directory.")])]),e._v(" "),a("p",[a("code",[e._v('rvt2 --source 01 -j windows.JOB path1/to/artifact --params volume_id="p01"')]),e._v(" "),a("code",[e._v('rvt2 --source 01 -j windows.JOB path2/to/artifact --params volume_id="p02"')])]),e._v(" "),a("h3",{attrs:{id:"extensive-forensic-analysys"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#extensive-forensic-analysys"}},[e._v("#")]),e._v(" Extensive forensic analysys")]),e._v(" "),a("p",[e._v("Given the amount of different Windows artifacts RVT2 is able to parse, when doing a general analysis it may be recommended to run them all with a single command. This command includes the mounting process.")]),e._v(" "),a("p",[a("code",[e._v("rvt2 --casename CASE --source 01 -j windows.preforensics")])]),e._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),a("p",[e._v("This job is assuming the main source of analysis is a disk image is located under "),a("code",[e._v("MORGUE/IMAGES/CASE/image.dd")]),e._v(".")])]),e._v(" "),a("p",[e._v("All the parsed results will be allocated on its standard output location. See the job's help to obtain the list of artifacts parsed as well as it's output locatins:")]),e._v(" "),a("p",[a("code",[e._v("rvt2 -j help windows.preforensics")])]),e._v(" "),a("p",[e._v("Individual artifacts can be parsed separately with any of the jobs explained in next examples, either provinding the artifact file as the argument to the job, or taking the root mouonting directory as the place to automatically search for them.")]),e._v(" "),a("h3",{attrs:{id:"registry"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#registry"}},[e._v("#")]),e._v(" Registry")]),e._v(" "),a("p",[e._v("RVT2 uses regripper and other tools to extract and classify information provided by Windows registry hives. Hives parsed include: SYSTEM, SECURITY, SOFTWARE, SAM, NTUSER.DAT, usrclass.dat, AmCache and SysCache.")]),e._v(" "),a("ul",[a("li",[e._v("Parse all registry hives on a mounted source")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 --source 01 -j windows.registry_hives")])]),e._v(" "),a("ul",[a("li",[e._v("Parse any registry hives under a custom directory")])]),e._v(" "),a("p",[e._v("You can provide a directory containing hives as an argument. "),a("code",[e._v("NTUSER.DAT")]),e._v(" and "),a("code",[e._v("usrclass.dat")]),e._v(" hives are expected to be stored undere a username folder inside the directory set as path. For example, provide a directory with the next structure:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("  hives_folder/\n  |-- SECURITY\n  |-- SYSTEM\n  |-- User_A\n      |-- NTUSER.DAT\n  |-- User_B\n      |-- usrclass.dat\n")])])]),a("p",[a("code",[e._v("rvt2 --source 01 -j windows.registry_hives path/to/hives_folder")])]),e._v(" "),a("ul",[a("li",[e._v("Parse specific hives or some keys only.")])]),e._v(" "),a("p",[e._v("Even though "),a("code",[e._v("windows.registry_hives")]),e._v(" includes all of them, you can opt to parse only some hives:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("rvt2 -j windows.amcache\nrvt2 -j windows.shimcache\nrvt2 -j windows.syscache\n")])])]),a("p",[e._v("Some specific keys under registry can be obtained using other tools than regripper. They require an external command to run. This command supplied as a parameter is a Python string template accepting variables.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('rvt2 -j windows.userassist--params cmd="{executable} -f {hive} --csv {outdir}"\nrvt2 -j windows.userassist_report\n')])])]),a("h3",{attrs:{id:"lnk-and-jumplists"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lnk-and-jumplists"}},[e._v("#")]),e._v(" Lnk and Jumplists")]),e._v(" "),a("ul",[a("li",[e._v("Search and parse all lnk, automaticdestinations-ms and customdestinations-ms files.")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 -j windows.recentfiles_default")])]),e._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),a("p",[e._v("This job will search for any .lnk file on disk. You must execute "),a("code",[e._v("allocfiles")]),e._v(" job at some point before running "),a("code",[e._v("windows.recentfiles_default")])])]),e._v(" "),a("ul",[a("li",[e._v("Parse any lnk, automaticdestinations-ms or customdestinations-ms under a provided directory. Save results to custom folder.")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 -j windows.recentfiles path/to/lnks_folder --params outdir=/path/to/custom_dir")])]),e._v(" "),a("h3",{attrs:{id:"event-logs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#event-logs"}},[e._v("#")]),e._v(" Event Logs")]),e._v(" "),a("ul",[a("li",[e._v("Parse all evtx files in a directory to json format. If no argument is provided, evtx will be searched on the common location: "),a("code",[e._v("Windows/System32/winevt/Logs")])])]),e._v(" "),a("p",[a("code",[e._v("rvt2 -j windows.events /path/to/evtx_folder")])]),e._v(" "),a("ul",[a("li",[e._v("Gather information from related events. Takes the output file generated by windows.events as the input argument.")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 -j windows.eventartifacts")])]),e._v(" "),a("ul",[a("li",[e._v("Convert and gather information about all evtx in a source")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 -j windows.events_global")])]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),a("p",[e._v("Generated json output can later be indexed for better exploration using job "),a("code",[e._v("events.event_logs")]),e._v(". See indexing examples about events_timeline.")])]),e._v(" "),a("h3",{attrs:{id:"usnjrnl-the-journal-log-of-ntfs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#usnjrnl-the-journal-log-of-ntfs"}},[e._v("#")]),e._v(" UsnJrnl. The journal log of NTFS")]),e._v(" "),a("ul",[a("li",[e._v("Parse individual UsnJrnl file ("),a("code",[e._v("$UsnJrnl:$J")]),e._v(")")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 -j windows.usnjrnl")])]),e._v(" "),a("ul",[a("li",[e._v("Parse UsnJrnl inside a disk image")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 -j windows.usnjrnl_all")])]),e._v(" "),a("h3",{attrs:{id:"execution-artifacts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#execution-artifacts"}},[e._v("#")]),e._v(" Execution artifacts")]),e._v(" "),a("ul",[a("li",[e._v("Parse all prefetch (.pf) files under a provided directory")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 -j windows.prefetch /path/to/folder_with_pf_files")])]),e._v(" "),a("ul",[a("li",[e._v("Extract and parse Windows artifacts related with applications execution (Prefetch, RFC, CCM). It will search on all known locations under the source mounting point")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 -j windows.execution")])]),e._v(" "),a("h3",{attrs:{id:"recycle-bin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#recycle-bin"}},[e._v("#")]),e._v(" Recycle Bin")]),e._v(" "),a("ul",[a("li",[e._v("List all files at Recycle Bin")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 --source 01 -j windows.recycle")])]),e._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),a("p",[e._v("This job makes use of the timeline and other VSS (if existing) to get deleted files information otherwise not accessible. Run "),a("code",[e._v("fs_timeline")]),e._v(" or "),a("code",[e._v("mft_timeline")]),e._v(" before this job, and ideally mount all VSS.")])]),e._v(" "),a("h3",{attrs:{id:"volume-shadow-snapshots-vss"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#volume-shadow-snapshots-vss"}},[e._v("#")]),e._v(" Volume Shadow Snapshots (VSS)")]),e._v(" "),a("ul",[a("li",[e._v("Mount all VSS present on a disk")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 --source 01 -j mount --params vss=True")])]),e._v(" "),a("p",[e._v("This job will create and mount new sources in the folder structure, one for each VSS found. They will follow the format "),a("code",[e._v("SOURCE_vXpY_day_time")]),e._v(". For example, if an VSS is found at partition 03 of source "),a("code",[e._v("SOURCE")]),e._v(', that was created at "2020/01/25 12:55:30", a new source '),a("code",[e._v("SOURCE_v1p03_200125_125530")]),e._v(" will be created on the case directory.")]),e._v(" "),a("p",[e._v("Then, you can run any RVT2 job on this new source as any other regular source. There are only a few jobs that need an special treatment when treatment with VSS sources: "),a("code",[e._v("fs_timeline")]),e._v(", "),a("code",[e._v("windows.usnjrnl")]),e._v(" and "),a("code",[e._v("windows.recycle")]),e._v(". They will need the additional parameter "),a("code",[e._v("vss=True")]),e._v(".")]),e._v(" "),a("ul",[a("li",[e._v("Process the filesystem timeline of a VSS")])]),e._v(" "),a("p",[e._v("All jobs to parse VSS information must be executed taking as source the new generated vss source.")]),e._v(" "),a("p",[a("code",[e._v("rvt2 --source 01_v1p01_200101_120000 -j fs_timeline --params vss=True")])]),e._v(" "),a("h2",{attrs:{id:"ios"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ios"}},[e._v("#")]),e._v(" iOS")]),e._v(" "),a("h3",{attrs:{id:"unbacking-ios-backup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#unbacking-ios-backup"}},[e._v("#")]),e._v(" Unbacking iOS backup")]),e._v(" "),a("ul",[a("li",[e._v("Unback an iOS backup directory or zip. Case without encryption:")])]),e._v(" "),a("p",[e._v("The path to the main job is the path to the folder containing the backup, or a .zip file containing the backup.")]),e._v(" "),a("p",[a("code",[e._v("rvt2 --source 01 -j ios.unback /path/to/iOS.zip")])]),e._v(" "),a("ul",[a("li",[e._v("Unback an encrypted iOS backup directory or encrypted zip:")])]),e._v(" "),a("p",[e._v("Currently, the RVT2 does not include directly the tools to decrypt an iOS backup and you must install or clone an external tool such as (https://github.com/dinosec/iphone-dataprotection).")]),e._v(" "),a("p",[a("code",[e._v('rvt2 --source 01 -j ios.unback /path/to/iOS.zip --params unback_command="PATH_TO_IOS_DATAPROTECTION/python_scripts/backup_tool.py {bk_path} {extract_path}"')])]),e._v(" "),a("h3",{attrs:{id:"parsing-ios-databases"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#parsing-ios-databases"}},[e._v("#")]),e._v(" Parsing iOS databases")]),e._v(" "),a("ul",[a("li",[e._v("Parse the most common databases on iOS (powerlog, call_history, contacts, datausage, safarihistory, location, ...)")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 -j ios.characterize")]),e._v(" "),a("code",[e._v("rvt2 -j ios.apollo_auto")]),e._v(" "),a("code",[e._v("rvt2 -j ios.databases")])]),e._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),a("p",[e._v("RVT2 makes use of the Apollo Project (https://github.com/mac4n6/APOLLO) to query most databases. The configuration is specific to iOS version. "),a("code",[e._v("ios.apollo_auto")]),e._v(" will search automatically for source version, but may fail for the newest versions.")])]),e._v(" "),a("h3",{attrs:{id:"whatsapp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#whatsapp"}},[e._v("#")]),e._v(" WhatsApp")]),e._v(" "),a("ul",[a("li",[e._v("Parse all conversations stored in WhatsApp database")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 -j ios.whatsapp")])]),e._v(" "),a("p",[e._v("Output is splitted in folders where the name is taken from the group id.")]),e._v(" "),a("ul",[a("li",[e._v("Convert obtained conversations to html format (reproducing WhatsApp style)")])]),e._v(" "),a("p",[e._v("You must identify first which conversation to convert, by getting its "),a("code",[e._v("message_group")]),e._v(" number.")]),e._v(" "),a("p",[a("code",[e._v("rvt2 -j ios.chat_to_html --params message_group=1234")])]),e._v(" "),a("h2",{attrs:{id:"indexation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#indexation"}},[e._v("#")]),e._v(" Indexation")]),e._v(" "),a("p",[e._v("RVT2 provides a set of jobs designated to create "),a("em",[e._v("json")]),e._v(" documents suitable to be indexed at an Elastic server.")]),e._v(" "),a("p",[e._v("The indexing process to ElasticSearch with RVT2 is generally divided in two steps:")]),e._v(" "),a("ul",[a("li",[e._v("Generate, from any kind of data (csv files, parsed directories, artifacts results, ...), a resulting "),a("em",[e._v("json")]),e._v(" document with a format suitable to be indexed at ElasticSearch.")]),e._v(" "),a("li",[e._v("Save or update the previous document to ElasticSearch")])]),e._v(" "),a("h3",{attrs:{id:"getting-files-metadata-inforamtion-with-tika"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getting-files-metadata-inforamtion-with-tika"}},[e._v("#")]),e._v(" Getting files metadata inforamtion with Tika")]),e._v(" "),a("p",[e._v("As stated in section "),a("a",{attrs:{href:"https://incidedigital.github.io/rvt2-docs/rvt2/configure.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Configuration and Running"),a("OutboundLink")],1),e._v(", if you use the Tika module, you must run Tika in server mode by running run.sh inside the $RVT2_HOME/external_tools/tika directory.")]),e._v(" "),a("ul",[a("li",[e._v("Parse all the files in a directory (and subdirectories). Set the index_name to a custom one. Output results will be found at "),a("code",[e._v("MORGUE/CASENAME/SOURCE/output/indexer/SOURCE.json")]),e._v(".")])]),e._v(" "),a("p",[a("code",[e._v('rvt2 -j indexer.directory DIRECTORY_TO_BE_PARSED --params name="my_index"')])]),e._v(" "),a("ul",[a("li",[e._v("Parse only some categories of files whithin a certain directory and set the output filename. This is useful when the analyst is interested only in some kind of files, and reduces the number of files parsed significantly. Predefined categories can be found in "),a("code",[e._v("conf/file_categories.cfg")]),e._v(" and include "),a("em",[e._v("office, executable, compressed, plain, audio, video, image, email, crypto, geographic")]),e._v(" and "),a("em",[e._v("database")]),e._v(".")])]),e._v(" "),a("p",[a("code",[e._v('rvt2 -j indexer.directory DIRECTORY_TO_BE_PARSED --params filter="email,office" outfile="/morgue/mycase/mysource/data_to_be_indexed.json"')])]),e._v(" "),a("h3",{attrs:{id:"saving-results-to-an-instance-of-elasticsearch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#saving-results-to-an-instance-of-elasticsearch"}},[e._v("#")]),e._v(" Saving results to an instance of ElasticSearch.")]),e._v(" "),a("p",[e._v("Before using any of these jobs it is advisable to configure the ElasticSearch server and credentials that are going to be used. These parameters are defined in the "),a("code",[e._v("indexer")]),e._v(" configuration section:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("[indexer]\nes_hosts: http://localhost:9200\nes_username:\nes_password:\n")])])]),a("p",[e._v("They can be set by creating a new configuration file (see section "),a("a",{attrs:{href:"https://incidedigital.github.io/rvt2-docs/rvt2/configure.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Configuration and Running"),a("OutboundLink")],1),e._v(") or by invoking any job with additional global parameters:")]),e._v(" "),a("p",[a("code",[e._v("rvt2 -j INDEX_JOB --globals indexer:es_hosts=ELASTIC_SERVER_URL --globals indexer:es_username=USERNAME --globals indexer:es_password=PASSWORD")])]),e._v(" "),a("p",[e._v("Whichever the origin of the json file previously generated, "),a("code",[e._v("indexer.save")]),e._v(" job should be used to actually save and index those results.")]),e._v(" "),a("ul",[a("li",[e._v("Save a previously indexed database in an ElasticSearch server")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 -j indexer.save my_indexed_db.json")])]),e._v(" "),a("ul",[a("li",[e._v("Save file to ElasticSearch with a custom mapping")])]),e._v(" "),a("p",[a("code",[e._v("rvt2 -j indexer.save my_indexed_db.json --params mapping=/home/myuser/mymapping.json")])]),e._v(" "),a("h3",{attrs:{id:"parsing-mailbox"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#parsing-mailbox"}},[e._v("#")]),e._v(" Parsing mailbox")]),e._v(" "),a("p",[e._v("Thanks to "),a("code",[e._v("pffexport")]),e._v(" it is possible to parse mailbox from standard formats such as "),a("code",[e._v("pst")]),e._v(", "),a("code",[e._v("ost")]),e._v(" or "),a("code",[e._v("nst")]),e._v(". Then, results can be indexed for analysis.")]),e._v(" "),a("ul",[a("li",[e._v("Parse and index all mailboxes ("),a("em",[e._v("pst, ost, nst")]),e._v(") from a mounted source:")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("rvt2 -j indexer.mails\nrvt2 -j indexer.save /morgue/mycase/mysource/output/mail/pstfiles.csv\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),a("p",[e._v("If you only need to parse some of the pst files inside a mounted source, it is recommended to create a new source containing only links to those files, and then run "),a("code",[e._v("indexer.mails")]),e._v(" on that new source.")])]),e._v(" "),a("h3",{attrs:{id:"converting-data-to-elasticsearch-json-formats"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#converting-data-to-elasticsearch-json-formats"}},[e._v("#")]),e._v(" Converting data to ElasticSearch json formats")]),e._v(" "),a("p",[e._v("There's a few jobs available to transform common data file formats to a json structure as ElasticSearch demands in order to be indexed.")]),e._v(" "),a("ul",[a("li",[e._v("Convert and index a CSV file with custom index name")])]),e._v(" "),a("p",[a("code",[e._v('rvt2 -j indexer.convert_csv myfile.csv --params index_name="mydata" outfile="/morgue/mycase/mysource/mydata.json"')])]),e._v(" "),a("h3",{attrs:{id:"blind-searches"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#blind-searches"}},[e._v("#")]),e._v(" Blind Searches")]),e._v(" "),a("ul",[a("li",[e._v("Search for keywords on a parsed "),a("em",[e._v("json")]),e._v(" file. Kw must be written in a file, one for each line. Resulting output file will contain a subselection of matching entries from the original file.")])]),e._v(" "),a("p",[a("code",[e._v('rvt2 -j indexer.blind_searches JSON_FILE.json --params keyword_file="PATH_TO_KW_FILE" outfile="results.json"')])]),e._v(" "),a("ul",[a("li",[e._v("Query Elastic indexes, tag matches and export results.")])]),e._v(" "),a("p",[a("code",[e._v('rvt2 -j indexer.tag_and_export --params index_name="*-myindexes" query=\'"term1" AND *term2*\' tag="CUSTOM_TAG"')])]),e._v(" "),a("p",[e._v("Original index will be updated with tags inserted to matching documents. In addition, the generated json output, by default at "),a("code",[e._v("output/indexer/exported.json")]),e._v(", containing only matching documents, can be indexed elsewhere using "),a("code",[e._v("indexer.save")]),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"creating-an-events-timeline-from-different-artifacts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#creating-an-events-timeline-from-different-artifacts"}},[e._v("#")]),e._v(" Creating an events timeline from different artifacts")]),e._v(" "),a("p",[e._v("Currently, many parsed results from various artifacts (specially those coming from Windows partitions), can be adapted to merge in a single index following "),a("a",{attrs:{href:"https://www.elastic.co/guide/en/ecs/current/index.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Elastic Common Schema"),a("OutboundLink")],1),e._v(" mapping. This new timeline of any timestamped event extracted from a source may prove a great resource in any investigation.")]),e._v(" "),a("ul",[a("li",[e._v("Index all available artifacts creating an ECS timeline")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("rvt2 -j events.all\nrvt2 -j events.save\n")])])]),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),a("p",[e._v("You must parse any artifact before running "),a("code",[e._v("event.all")]),e._v(". This job assumes the generated output is located at default locations when searching for the data to index.")])])])}),[],!1,null,null,null);t.default=i.exports}}]);