<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Examples | Revealer Toolkit 2</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="An open source platform for forensics investigations">
    
    <link rel="preload" href="/rvt2-docs/assets/css/0.styles.b47c4fc0.css" as="style"><link rel="preload" href="/rvt2-docs/assets/js/app.b67eefe8.js" as="script"><link rel="preload" href="/rvt2-docs/assets/js/2.4edca1ff.js" as="script"><link rel="preload" href="/rvt2-docs/assets/js/21.26e614e3.js" as="script"><link rel="prefetch" href="/rvt2-docs/assets/js/10.45d30cfd.js"><link rel="prefetch" href="/rvt2-docs/assets/js/11.874b0e05.js"><link rel="prefetch" href="/rvt2-docs/assets/js/12.b73680ec.js"><link rel="prefetch" href="/rvt2-docs/assets/js/13.83f1c76a.js"><link rel="prefetch" href="/rvt2-docs/assets/js/14.3d32b666.js"><link rel="prefetch" href="/rvt2-docs/assets/js/15.6f13c765.js"><link rel="prefetch" href="/rvt2-docs/assets/js/16.9c59d656.js"><link rel="prefetch" href="/rvt2-docs/assets/js/17.137bb697.js"><link rel="prefetch" href="/rvt2-docs/assets/js/18.d3f18291.js"><link rel="prefetch" href="/rvt2-docs/assets/js/19.d5480db3.js"><link rel="prefetch" href="/rvt2-docs/assets/js/20.a4337a60.js"><link rel="prefetch" href="/rvt2-docs/assets/js/22.e975477b.js"><link rel="prefetch" href="/rvt2-docs/assets/js/23.e3e3c789.js"><link rel="prefetch" href="/rvt2-docs/assets/js/24.b1d62788.js"><link rel="prefetch" href="/rvt2-docs/assets/js/25.7895f199.js"><link rel="prefetch" href="/rvt2-docs/assets/js/26.f5abcf76.js"><link rel="prefetch" href="/rvt2-docs/assets/js/27.86128cc7.js"><link rel="prefetch" href="/rvt2-docs/assets/js/28.2398b9ae.js"><link rel="prefetch" href="/rvt2-docs/assets/js/3.728d972d.js"><link rel="prefetch" href="/rvt2-docs/assets/js/4.020c9e6e.js"><link rel="prefetch" href="/rvt2-docs/assets/js/5.694be8a1.js"><link rel="prefetch" href="/rvt2-docs/assets/js/6.307bf6ae.js"><link rel="prefetch" href="/rvt2-docs/assets/js/7.7916ded1.js"><link rel="prefetch" href="/rvt2-docs/assets/js/8.f9d991f1.js"><link rel="prefetch" href="/rvt2-docs/assets/js/9.c4f1f1cb.js">
    <link rel="stylesheet" href="/rvt2-docs/assets/css/0.styles.b47c4fc0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/rvt2-docs/" class="home-link router-link-active"><!----> <span class="site-name">Revealer Toolkit 2</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/rvt2-docs/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/rvt2-docs/rvt2/" class="nav-link router-link-active">
  RVT2
</a></div><div class="nav-item"><a href="/rvt2-docs/analyzer/" class="nav-link">
  RVT2-analyzer
</a></div><div class="nav-item"><a href="/rvt2-docs/resources/" class="nav-link">
  Resources
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/rvt2-docs/rvt2/examples.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  en
</a></li><li class="dropdown-item"><!----> <a href="/rvt2-docs/es/" class="nav-link">
  es
</a></li></ul></div></div> <a href="https://github.com/IncideDigital/rvt2" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/rvt2-docs/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/rvt2-docs/rvt2/" class="nav-link router-link-active">
  RVT2
</a></div><div class="nav-item"><a href="/rvt2-docs/analyzer/" class="nav-link">
  RVT2-analyzer
</a></div><div class="nav-item"><a href="/rvt2-docs/resources/" class="nav-link">
  Resources
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/rvt2-docs/rvt2/examples.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  en
</a></li><li class="dropdown-item"><!----> <a href="/rvt2-docs/es/" class="nav-link">
  es
</a></li></ul></div></div> <a href="https://github.com/IncideDigital/rvt2" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>RVT2</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rvt2-docs/rvt2/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/rvt2-docs/rvt2/install.html" class="sidebar-link">Installation</a></li><li><a href="/rvt2-docs/rvt2/definitions.html" class="sidebar-link">Basic concepts</a></li><li><a href="/rvt2-docs/rvt2/configure.html" class="sidebar-link">Configuration and running</a></li><li><a href="/rvt2-docs/rvt2/folder.html" class="sidebar-link">Folder structure</a></li><li><a href="/rvt2-docs/rvt2/base.html" class="sidebar-link">Base modules</a></li><li><a href="/rvt2-docs/rvt2/common.html" class="sidebar-link">Section common</a></li><li><a href="/rvt2-docs/rvt2/windows.html" class="sidebar-link">Section windows</a></li><li><a href="/rvt2-docs/rvt2/macos.html" class="sidebar-link">Section macos</a></li><li><a href="/rvt2-docs/rvt2/linux.html" class="sidebar-link">Section linux</a></li><li><a href="/rvt2-docs/rvt2/ios.html" class="sidebar-link">Section ios</a></li><li><a href="/rvt2-docs/rvt2/indexer.html" class="sidebar-link">Section indexer</a></li><li><a href="/rvt2-docs/rvt2/extend.html" class="sidebar-link">Plugin: extensions</a></li><li><a href="/rvt2-docs/rvt2/examples.html" aria-current="page" class="active sidebar-link">Examples</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rvt2-docs/rvt2/examples.html#general-configuration" class="sidebar-link">General configuration</a></li><li class="sidebar-sub-header"><a href="/rvt2-docs/rvt2/examples.html#common-jobs" class="sidebar-link">Common jobs</a></li><li class="sidebar-sub-header"><a href="/rvt2-docs/rvt2/examples.html#windows" class="sidebar-link">Windows</a></li><li class="sidebar-sub-header"><a href="/rvt2-docs/rvt2/examples.html#indexation" class="sidebar-link">Indexation</a></li><li class="sidebar-sub-header"><a href="/rvt2-docs/rvt2/examples.html#do-not-use-a-general-directory-structure" class="sidebar-link">Do not use a general directory structure</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>RVT2 analyzer</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Resources</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/rvt2-docs/contact.html" class="sidebar-link">Contact</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="examples"><a href="#examples" class="header-anchor">#</a> Examples</h1> <h2 id="general-configuration"><a href="#general-configuration" class="header-anchor">#</a> General configuration</h2> <h2 id="common-jobs"><a href="#common-jobs" class="header-anchor">#</a> Common jobs</h2> <h2 id="windows"><a href="#windows" class="header-anchor">#</a> Windows</h2> <h2 id="indexation"><a href="#indexation" class="header-anchor">#</a> Indexation</h2> <p>RVT2 provides a set of jobs designated to create <em>json</em> documents suitable to be indexed at an Elastic server.</p> <p>The indexing process to ElasticSearch with RVT2 is generally divided in two steps:</p> <ul><li>Generate, from any kind of data (csv files, parsed directories, artifacts results, ...), a resulting <em>json</em> document with a format suitable to be indexed at ElasticSearch.</li> <li>Save or update the previous document to ElasticSearch</li></ul> <h3 id="getting-files-metadata-inforamtion-with-tika"><a href="#getting-files-metadata-inforamtion-with-tika" class="header-anchor">#</a> Getting files metadata inforamtion with Tika</h3> <p>As stated in section <a href="https://incidedigital.github.io/rvt2-docs/rvt2/configure.html" target="_blank" rel="noopener noreferrer">Configuration and Running<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, if you use the Tika module, you must run Tika in server mode by running run.sh inside the $RVT2_HOME/external_tools/tika directory.</p> <ul><li>Parse all the files in a directory (and subdirectories). Set the index_name to a custom one. Output results will be found at <code>MORGUE/CASENAME/SOURCE/output/indexer/SOURCE.json</code>.</li></ul> <p><code>rvt2 -j indexer.directory DIRECTORY_TO_BE_PARSED --params name=&quot;my_index&quot;</code></p> <ul><li>Parse only some categories of files whithin a certain directory and set the output filename. This is useful when the analyst is interested only in some kind of files, and reduces the number of files parsed significantly. Predefined categories can be found in <code>conf/file_categories.cfg</code> and include <em>office, executable, compressed, plain, audio, video, image, email, crypto, geographic</em> and <em>database</em>.</li></ul> <p><code>rvt2 -j indexer.directory DIRECTORY_TO_BE_PARSED --params filter=&quot;email,office&quot; outfile=&quot;/morgue/mycase/mysource/data_to_be_indexed.json&quot;</code></p> <h3 id="saving-results-to-an-instance-of-elasticsearch"><a href="#saving-results-to-an-instance-of-elasticsearch" class="header-anchor">#</a> Saving results to an instance of ElasticSearch.</h3> <p>Before using any of these jobs it is advisable to configure the ElasticSearch server and credentials that are going to be used. These parameters are defined in the <code>indexer</code> configuration section:</p> <div class="language- extra-class"><pre class="language-text"><code>[indexer]
es_hosts: http://localhost:9200
es_username:
es_password:
</code></pre></div><p>They can be set by creating a new configuration file (see section <a href="https://incidedigital.github.io/rvt2-docs/rvt2/configure.html" target="_blank" rel="noopener noreferrer">Configuration and Running<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) or by invoking any job with additional global parameters:</p> <p><code>rvt2 -j INDEX_JOB --globals indexer:es_hosts=ELASTIC_SERVER_URL --globals indexer:es_username=USERNAME --globals indexer:es_password=PASSWORD</code></p> <p>Whichever the origin of the json file previously generated, <code>indexer.save</code> job should be used to actually save and index those results.</p> <ul><li>Save a previously indexed database in an ElasticSearch server</li></ul> <p><code>rvt2 -j indexer.save my_indexed_db.json</code></p> <ul><li>Save file to ElasticSearch with a custom mapping</li></ul> <p><code>rvt2 -j indexer.save my_indexed_db.json --params mapping=/home/myuser/mymapping.json</code></p> <h3 id="parsing-mailbox"><a href="#parsing-mailbox" class="header-anchor">#</a> Parsing mailbox</h3> <p>Thanks to <code>pffexport</code> it is possible to parse mailbox from standard formats such as <code>pst</code>, <code>ost</code> or <code>nst</code>. Then, results can be indexed for analysis.</p> <ul><li>Parse and index all mailboxes (<em>pst, ost, nst</em>) from a mounted source:</li></ul> <div class="language- extra-class"><pre class="language-text"><code>rvt2 -j indexer.mails
rvt2 -j indexer.save /morgue/mycase/mysource/output/mail/pstfiles.csv
</code></pre></div><p>:::info
If you only need to parse some of the pst files inside a mounted source, it is recommended to create a new source containing only links to those files, and then run <code>indexer.mails</code> on that new source.
:::</p> <h3 id="converting-data-to-elasticsearch-json-formats"><a href="#converting-data-to-elasticsearch-json-formats" class="header-anchor">#</a> Converting data to ElasticSearch json formats</h3> <p>There's a few jobs available to transform common data file formats to a json structure as ElasticSearch demands in order to be indexed.</p> <ul><li>Convert and index a CSV file with custom index name</li></ul> <p><code>rvt2 -j indexer.convert_csv myfile.csv --params index_name=&quot;mydata&quot; outfile=&quot;/morgue/mycase/mysource/mydata.json&quot;</code></p> <h3 id="blind-searches"><a href="#blind-searches" class="header-anchor">#</a> Blind Searches</h3> <ul><li>Search for keywords on a parsed <em>json</em> file. Kw must be written in a file, one for each line. Resulting output file will contain a subselection of matching entries from the original file.</li></ul> <p><code>rvt2 -j indexer.blind_searches JSON_FILE.json --params keyword_file=&quot;PATH_TO_KW_FILE&quot; outfile=&quot;results.json&quot;</code></p> <ul><li>Query Elastic indexes, tag matches and export results.</li></ul> <p><code>rvt2 -j indexer.tag_and_export --params index_name=&quot;*-myindexes&quot; query='&quot;term1&quot; AND *term2*' tag=&quot;CUSTOM_TAG&quot;</code></p> <p>Original index will be updated with tags inserted to matching documents. In addition, the generated json output, by default at <code>output/indexer/exported.json</code>, containing only matching documents, can be indexed elsewhere using <code>indexer.save</code>.</p> <h3 id="creating-a-timeline-of-events-from-different-artifacts"><a href="#creating-a-timeline-of-events-from-different-artifacts" class="header-anchor">#</a> Creating a timeline of events from different artifacts</h3> <p>Currently, many parsed results from various artifacts (specially those coming from Windows partitions), can be adapted to merge in a single index following <a href="https://www.elastic.co/guide/en/ecs/current/index.html" target="_blank" rel="noopener noreferrer">Elastic Common Schema<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> mapping. This new timeline of any timestamped event extracted from a source may prove a great resource in any investigation.</p> <p>:::info
Any artifacts must had been parsed before. This job assumes the generated output is located at default locations when searching for the data to index.
:::</p> <ul><li>Index all available artifacts creating an ECS timeline</li></ul> <div class="language- extra-class"><pre class="language-text"><code>rvt2 -j events.all
rvt2 -j events.save
</code></pre></div><h2 id="do-not-use-a-general-directory-structure"><a href="#do-not-use-a-general-directory-structure" class="header-anchor">#</a> Do not use a general directory structure</h2> <p>The default configuration uses the folder structure introduced in this document.
This structure is useful in a multiuser environment because you know where you
are going to find images and output files.</p> <p>Nevertheless, sometimes you need a fast analyze on a directory.
For example, in a directory there is a file <code>myiphone.zip</code> which includes the
backup of an iPhone. In this case, you can run on the same directory:</p> <div class="language- extra-class"><pre class="language-text"><code>rvt2 --source myiphone --globals imagedir=$(pwd) --globals casedir=$(pwd) -j ios.unback -- myiphone.zip
</code></pre></div><p>That is: define imagedir and casedir as current directory, unback and analyze
in directory <code>myiphone</code> (source name) the file <code>myiphone.zip</code>.</p> <p><code>--globals</code> overwrite a variable in all configuration files. Its syntax is
<code>[sectionname:]varname=value</code>.  If <code>sectionname</code> is not provided, <code>DEFAULT</code> is
used.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/IncideDigital/rvt2-docs/edit/master/docs/rvt2/examples.md" target="_blank" rel="noopener noreferrer">Help us to improve this page!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/25/2021, 3:12:48 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/rvt2-docs/rvt2/extend.html" class="prev">
        Plugin: extensions
      </a></span> <span class="next"><a href="/rvt2-docs/analyzer/">
        User manual
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/rvt2-docs/assets/js/app.b67eefe8.js" defer></script><script src="/rvt2-docs/assets/js/2.4edca1ff.js" defer></script><script src="/rvt2-docs/assets/js/21.26e614e3.js" defer></script>
  </body>
</html>
