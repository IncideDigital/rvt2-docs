<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Section windows | Revealer Toolkit 2</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="An open source platform for forensics investigations">
    
    <link rel="preload" href="/rvt2-docs/assets/css/0.styles.b47c4fc0.css" as="style"><link rel="preload" href="/rvt2-docs/assets/js/app.143db98b.js" as="script"><link rel="preload" href="/rvt2-docs/assets/js/2.4edca1ff.js" as="script"><link rel="preload" href="/rvt2-docs/assets/js/28.0185c4b0.js" as="script"><link rel="prefetch" href="/rvt2-docs/assets/js/10.45d30cfd.js"><link rel="prefetch" href="/rvt2-docs/assets/js/11.874b0e05.js"><link rel="prefetch" href="/rvt2-docs/assets/js/12.b73680ec.js"><link rel="prefetch" href="/rvt2-docs/assets/js/13.83f1c76a.js"><link rel="prefetch" href="/rvt2-docs/assets/js/14.3d32b666.js"><link rel="prefetch" href="/rvt2-docs/assets/js/15.b49223be.js"><link rel="prefetch" href="/rvt2-docs/assets/js/16.9c59d656.js"><link rel="prefetch" href="/rvt2-docs/assets/js/17.137bb697.js"><link rel="prefetch" href="/rvt2-docs/assets/js/18.d3f18291.js"><link rel="prefetch" href="/rvt2-docs/assets/js/19.ddc31ae9.js"><link rel="prefetch" href="/rvt2-docs/assets/js/20.d31509c9.js"><link rel="prefetch" href="/rvt2-docs/assets/js/21.ea869f68.js"><link rel="prefetch" href="/rvt2-docs/assets/js/22.e975477b.js"><link rel="prefetch" href="/rvt2-docs/assets/js/23.6fc2b508.js"><link rel="prefetch" href="/rvt2-docs/assets/js/24.b1d62788.js"><link rel="prefetch" href="/rvt2-docs/assets/js/25.5ec3bdb6.js"><link rel="prefetch" href="/rvt2-docs/assets/js/26.6b0a91c7.js"><link rel="prefetch" href="/rvt2-docs/assets/js/27.bd25020d.js"><link rel="prefetch" href="/rvt2-docs/assets/js/3.728d972d.js"><link rel="prefetch" href="/rvt2-docs/assets/js/4.020c9e6e.js"><link rel="prefetch" href="/rvt2-docs/assets/js/5.694be8a1.js"><link rel="prefetch" href="/rvt2-docs/assets/js/6.307bf6ae.js"><link rel="prefetch" href="/rvt2-docs/assets/js/7.b986c774.js"><link rel="prefetch" href="/rvt2-docs/assets/js/8.f9d991f1.js"><link rel="prefetch" href="/rvt2-docs/assets/js/9.c4f1f1cb.js">
    <link rel="stylesheet" href="/rvt2-docs/assets/css/0.styles.b47c4fc0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/rvt2-docs/" class="home-link router-link-active"><!----> <span class="site-name">Revealer Toolkit 2</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/rvt2-docs/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/rvt2-docs/rvt2/" class="nav-link router-link-active">
  RVT2
</a></div><div class="nav-item"><a href="/rvt2-docs/analyzer/" class="nav-link">
  RVT2-analyzer
</a></div><div class="nav-item"><a href="/rvt2-docs/resources/" class="nav-link">
  Resources
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/rvt2-docs/rvt2/windows.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  en
</a></li><li class="dropdown-item"><!----> <a href="/rvt2-docs/es/" class="nav-link">
  es
</a></li></ul></div></div> <a href="https://github.com/IncideDigital/rvt2" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/rvt2-docs/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/rvt2-docs/rvt2/" class="nav-link router-link-active">
  RVT2
</a></div><div class="nav-item"><a href="/rvt2-docs/analyzer/" class="nav-link">
  RVT2-analyzer
</a></div><div class="nav-item"><a href="/rvt2-docs/resources/" class="nav-link">
  Resources
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/rvt2-docs/rvt2/windows.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  en
</a></li><li class="dropdown-item"><!----> <a href="/rvt2-docs/es/" class="nav-link">
  es
</a></li></ul></div></div> <a href="https://github.com/IncideDigital/rvt2" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>RVT2</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rvt2-docs/rvt2/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/rvt2-docs/rvt2/install.html" class="sidebar-link">Installation</a></li><li><a href="/rvt2-docs/rvt2/definitions.html" class="sidebar-link">Basic concepts</a></li><li><a href="/rvt2-docs/rvt2/configure.html" class="sidebar-link">Configuration and running</a></li><li><a href="/rvt2-docs/rvt2/folder.html" class="sidebar-link">Folder structure</a></li><li><a href="/rvt2-docs/rvt2/base.html" class="sidebar-link">Base modules</a></li><li><a href="/rvt2-docs/rvt2/common.html" class="sidebar-link">Section common</a></li><li><a href="/rvt2-docs/rvt2/windows.html" aria-current="page" class="active sidebar-link">Section windows</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rvt2-docs/rvt2/windows.html#jobs" class="sidebar-link">Jobs</a></li></ul></li><li><a href="/rvt2-docs/rvt2/macos.html" class="sidebar-link">Plugin: macos</a></li><li><a href="/rvt2-docs/rvt2/linux.html" class="sidebar-link">Plugin: linux</a></li><li><a href="/rvt2-docs/rvt2/ios.html" class="sidebar-link">Section ios</a></li><li><a href="/rvt2-docs/rvt2/indexer.html" class="sidebar-link">Section indexer</a></li><li><a href="/rvt2-docs/rvt2/extend.html" class="sidebar-link">Plugin: extensions</a></li><li><a href="/rvt2-docs/rvt2/examples.html" class="sidebar-link">Examples</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>RVT2 analyzer</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Resources</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/rvt2-docs/contact.html" class="sidebar-link">Contact</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="section-windows"><a href="#section-windows" class="header-anchor">#</a> Section windows</h1> <p>This plugin extracts and analyzes forensic artifacts from a Windows system.</p> <h2 id="jobs"><a href="#jobs" class="header-anchor">#</a> Jobs</h2> <ul><li><code>windows.preforensics</code>: Main set of forensic analysis jobs to run on a Windows disk partition.</li> <li><code>windows.characterize</code>: Describes basic information about Windows partitions and users.</li> <li><code>windows.recentfiles</code>: Parse lnk and jumplist files in a directory.</li> <li><code>windows.recentfiles_report</code>: Generates a summary file with all recent files sources.</li> <li><code>windows.recentfiles_default</code>: Parse all lnk and jumplist files present in a mounted source. Generates a summary file with all recent files sources.</li> <li><code>windows.execution</code>: Extract and parse Windows artifacts related with applications execution (Prefetch, RFC).</li> <li><code>windows.prefetch</code>: Extract and parse Windows artifacts related with applications execution (Prefetch)</li> <li><code>windows.rfc</code>: Extract and parse Windows artifacts related with applications execution (RFC)</li> <li><code>windows.CCM</code>: Extracts SCCM Software Metering history to get more information about executions</li> <li><code>windows.autorip</code>: Extracts an extensive set of keys from Windows Registry hives. Results are organized according to its information type.</li> <li><code>windows.registry_hives</code>: Extracts an extensive set of keys from Windows Registry hives using regripper. Results are organized according to its information type.</li> <li><code>windows.amcache</code>: Parse AmCache hive</li> <li><code>windows.shimcache</code>: Parse ShimCache hive</li> <li><code>windows.syscache</code>: Parse SysCache hive</li> <li><code>windows.appcompatcache</code>: Parse AppcompatCache from SYSTEM registry hive</li> <li><code>windows.userassist</code>: Parse userassist key in NTUSER.DAT hive. By default uses RECmd.exe to parse. Windows environment is needed to execute it.</li> <li><code>windows.userassist_report</code>: Generates a summary file with all userassist files sources.</li> <li><code>windows.shellbags</code>: Parse Shellbags in NTUSER.DAT or usrclass.dat hives. By default uses SBECmd.exe to parse. Windows environment is needed to execute it.</li> <li><code>windows.shellbags_report</code>: Generates a summary file with all shellbags files sources.</li> <li><code>windows.registry</code>: Dumps Windows Registry hives. Used for indexing purposes.</li> <li><code>windows.events</code>: Parse Windows event files to get relevant logs events.</li> <li><code>windows.eventartifacts</code>: Extracts Windows artifacts from event files. It is required to execute <code>windows.events</code> before this job</li> <li><code>windows.scheduled_tasks_all</code>: Parse Task Scheduler Service artifacts such as SCHEDLGU.TXT and .job files</li> <li><code>windows.scheduled_tasks</code>: Parse Task Scheduler Service artifacts such as SCHEDLGU.TXT and .job files</li> <li><code>windows.recycle</code>: Parse files in (or deleted from) Windows Recycle Bin</li> <li><code>windows.srum</code>: Extract and parse SRUM (System Resource Utilization Monitor) from a windows OS</li> <li><code>windows.usb</code>: Extracts USB drives data about drivers installation from setupapi.dev.log</li> <li><code>windows.usnjrnl_all</code>: Parse all NTFS UsnJrnl files found in an image.</li> <li><code>windows.usnjrnl</code>: Parse NTFS UsnJrnl, the journal log of NTFS. You will find recent oprations on files: deletion, modification, renaming...</li> <li><code>windows.hiberfil</code>: Decompress hiberfil.sys and extract some artifacts</li> <li><code>windows.bits</code>: Parse Background Intelligent Transfer Service (BITS). This is a service to transfer binaries between systems, used mainly by Microsoft Update and similar programs.</li> <li><code>windows.activity_cache</code>: Parse ActivitiesCache database.</li> <li><code>windows.i30</code>: Parse I30 files to obtain a timeline</li> <li><code>windows.source_summary</code>: Tables summary of previously parsed artefacts</li> <li><code>windows.IR_preforensics</code>: Main set of forensic analysis jobs to run on Windows artifacts. It assumes artifact files are located under <code>MORGUE/CASENAME/SOURCE/mnt</code></li></ul> <h3 id="job-windows-preforensics"><a href="#job-windows-preforensics" class="header-anchor">#</a> Job <code>windows.preforensics</code></h3> <p>Main set of forensic analysis jobs to run on a Windows disk partition.</p> <p>Artifacts parsed:</p> <ul><li>MFT Timeline</li> <li>Characterize: <code>MORGUE/CASENAME/SOURCE/analysis/disk_summary.md</code>, <code>MORGUE/CASENAME/SOURCE/analysis/os_summary.md</code></li> <li>Registry (using Regripper): <code>MORGUE/CASENAME/SOURCE/output/windows/hives</code></li> <li>Event Logs:</li> <li><code>MORGUE/CASENAME/SOURCE/output/windows/events</code></li> <li><code>MORGUE/CASENAME/SOURCE/analysis/events</code></li> <li>Lnk and Jumplists:</li> <li><code>MORGUE/CASENAME/SOURCE/output/windows/recentfiles</code></li> <li><code>MORGUE/CASENAME/SOURCE/analysis/recentfiles</code></li> <li>UsnJrnl: <code>MORGUE/CASENAME/SOURCE/output/windows/usnjrnl</code></li> <li>Prefetch: <code>MORGUE/CASENAME/SOURCE/output/windows/execution</code></li> <li>Browser History: <code>MORGUE/CASENAME/SOURCE/output/browsers</code></li> <li>Recycle Bin: <code>MORGUE/CASENAME/SOURCE/output/windows/recyclebin</code></li> <li>RFC: <code>MORGUE/CASENAME/SOURCE/output/windows/execution</code></li> <li>Activities Cache: <code>MORGUE/CASENAME/SOURCE/output/windows/execution</code></li> <li>USB artifacts: <code>MORGUE/CASENAME/SOURCE/output/windows/usb</code></li> <li>BAM: <code>MORGUE/CASENAME/SOURCE/output/windows/execution</code></li></ul> <h4 id="configurable-parameters"><a href="#configurable-parameters" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>vss</code></td> <td>process Volume Shadow Snapshots</td> <td><code>False</code></td></tr> <tr><td><code>timeline_outdir</code></td> <td></td> <td><code>MORGUE/CASENAME/SOURCE/output/timeline</code></td></tr></tbody></table> <h3 id="job-windows-characterize"><a href="#job-windows-characterize" class="header-anchor">#</a> Job <code>windows.characterize</code></h3> <p>Describes basic information about Windows partitions and users.
Information includes:</p> <ul><li>OS name, version, ID and owner</li> <li>OS Installation (or update) date</li> <li>Creation and last login/logoff dates for every user present</li></ul> <h4 id="configurable-parameters-2"><a href="#configurable-parameters-2" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>outfile</code></td> <td>path to file were results are stored (in markdown format)</td> <td><code>MORGUE/CASENAME/SOURCE/analysis/os_summary.md</code></td></tr> <tr><td><code>aux_file</code></td> <td>json file where OS info will be stored and used by other jobs</td> <td><code>MORGUE/CASENAME/SOURCE/output/auxdir/os_info.json</code></td></tr> <tr><td><code>template_file</code></td> <td>mako template to display results</td> <td><code>templates/os_summary.mako</code></td></tr> <tr><td><code>file_exists</code></td> <td></td> <td><code>OVERWRITE</code></td></tr></tbody></table> <h3 id="job-windows-recentfiles"><a href="#job-windows-recentfiles" class="header-anchor">#</a> Job <code>windows.recentfiles</code></h3> <p>Parse lnk and jumplist files in a directory.
It is recommended to run <code>windows.recentfiles_report</code> after parsing all possible recentfiles with the present job</p> <h4 id="configurable-parameters-3"><a href="#configurable-parameters-3" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>path</code></td> <td>absolute path to folder containing lnk</td> <td>automaticdestestination</td></tr> <tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/recentfiles</code></td></tr> <tr><td><code>appid</code></td> <td>path to file relating applications id with names</td> <td><code>/home/jvera/Incide/Projects/rvt2/plugins/windows/appID.txt</code></td></tr> <tr><td><code>volume_id</code></td> <td>volume identifier, such as partition number. Ex: p03</td> <td>``</td></tr> <tr><td><code>username</code></td> <td>User name identifier</td> <td>``</td></tr></tbody></table> <h3 id="job-windows-recentfiles-report"><a href="#job-windows-recentfiles-report" class="header-anchor">#</a> Job <code>windows.recentfiles_report</code></h3> <p>Generates a summary file with all recent files sources.</p> <h4 id="configurable-parameters-4"><a href="#configurable-parameters-4" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>lnk_dir</code></td> <td>path to directory where files generated by windows.recentfiles are be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/recentfiles</code></td></tr> <tr><td><code>outdir</code></td> <td>path to directory where generated analysis files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/analysis/recentfiles</code></td></tr></tbody></table> <h3 id="job-windows-recentfiles-default"><a href="#job-windows-recentfiles-default" class="header-anchor">#</a> Job <code>windows.recentfiles_default</code></h3> <p>Parse all lnk and jumplist files present in a mounted source. Generates a summary file with all recent files sources.</p> <h4 id="configurable-parameters-5"><a href="#configurable-parameters-5" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>vss</code></td> <td>process Volume Shadow Snapshots</td> <td><code>False</code></td></tr> <tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/recentfiles</code></td></tr> <tr><td><code>outdir_analysis</code></td> <td>path to directory where generated analysis files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/analysis/recentfiles</code></td></tr> <tr><td><code>appid</code></td> <td>path to file relating applications id with names</td> <td><code>/home/jvera/Incide/Projects/rvt2/plugins/windows/appID.txt</code></td></tr></tbody></table> <h3 id="job-windows-execution"><a href="#job-windows-execution" class="header-anchor">#</a> Job <code>windows.execution</code></h3> <p>Extract and parse Windows artifacts related with applications execution (Prefetch, RFC).</p> <ul><li>Prefetch: files designed to speed up the execution of processes. Contain DLLs used, how many times the executable run (in &lt;W10), timestamp</li> <li>RFC: process creation data stored by ProgramDataUpdater.</li></ul> <h4 id="configurable-parameters-6"><a href="#configurable-parameters-6" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/execution</code></td></tr> <tr><td><code>mountdir</code></td> <td></td> <td><code>MORGUE/CASENAME/SOURCE/mnt</code></td></tr></tbody></table> <h3 id="job-windows-prefetch"><a href="#job-windows-prefetch" class="header-anchor">#</a> Job <code>windows.prefetch</code></h3> <p>Extract and parse Windows artifacts related with applications execution (Prefetch)</p> <h4 id="configurable-parameters-7"><a href="#configurable-parameters-7" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>path</code></td> <td>path to directory containing pf files</td> <td>``</td></tr> <tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/execution</code></td></tr> <tr><td><code>volume_id</code></td> <td>volume identifier, such as partition number. Ex: p03</td> <td>``</td></tr></tbody></table> <h3 id="job-windows-rfc"><a href="#job-windows-rfc" class="header-anchor">#</a> Job <code>windows.rfc</code></h3> <p>Extract and parse Windows artifacts related with applications execution (RFC)</p> <h4 id="configurable-parameters-8"><a href="#configurable-parameters-8" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>path</code></td> <td>path to RecentFileCache.bcf file</td> <td>``</td></tr> <tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/execution</code></td></tr> <tr><td><code>volume_id</code></td> <td>volume identifier, such as partition number. Ex: p03</td> <td>``</td></tr></tbody></table> <h3 id="job-windows-ccm"><a href="#job-windows-ccm" class="header-anchor">#</a> Job <code>windows.CCM</code></h3> <p>Extracts SCCM Software Metering history to get more information about executions
The path is the absolute location of Windows/System32/wbem/Repository folder.</p> <h4 id="configurable-parameters-9"><a href="#configurable-parameters-9" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>path</code></td> <td>absolute path Windows/System32/wbem/Repository directory</td> <td>``</td></tr> <tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/execution</code></td></tr> <tr><td><code>volume_id</code></td> <td>volume identifier, such as partition number. Ex: p03</td> <td>``</td></tr></tbody></table> <h3 id="job-windows-autorip"><a href="#job-windows-autorip" class="header-anchor">#</a> Job <code>windows.autorip</code></h3> <p>Extracts an extensive set of keys from Windows Registry hives. Results are organized according to its information type.
Expects a directory containing hives as an argument. <code>NTUSER.DAT</code> and <code>usrclass.dat</code> hives are expected to be stored in a username folder inside the directory set as path.
The list of regripper modules, its description and output file can be found at: <code>/home/jvera/Incide/Projects/rvt2/plugins/windows/autorip.json</code></p> <p>Some of the airtifacts are:</p> <ul><li>Shellbags: Shellbag information is available only for folders that have been opened and closed in Windows Explorer at least once.
The existence of a Shellbag sub-key for a given directory indicates that the specific user account once visited that folder.</li> <li>Jumplists: Recent documents in a program that is pinned to your taskbar.</li> <li>Recentdocs: Recent documents, as listed in the registry. They may or not may be the same than the jumplist. They are used (but not only) in Microsoft Office.</li> <li>Shimcache: tracks compatibilities issues with executed programs: path, size, last modified time, last updated time, process execution flag</li> <li>Amcache: stores information about executed programs: path, executed time, deleted time, first installation</li></ul> <h4 id="configurable-parameters-10"><a href="#configurable-parameters-10" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>vss</code></td> <td>process Volume Shadow Snapshot</td> <td><code>False</code></td></tr> <tr><td><code>ripplugins</code></td> <td>path to json file containing the organized list of regripper plugins to run</td> <td><code>/home/jvera/Incide/Projects/rvt2/plugins/windows/autorip.json</code></td></tr> <tr><td><code>pluginshives</code></td> <td>path to json file associating each regripper plugin with a list of hives</td> <td><code>/home/jvera/Incide/Projects/rvt2/plugins/windows/regripper_plugins.json</code></td></tr> <tr><td><code>errorfile</code></td> <td>path to log file to register regripper errors</td> <td><code>MORGUE/CASENAME/SOURCE/SOURCE_aux.log</code></td></tr> <tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/hives</code></td></tr></tbody></table> <h3 id="job-windows-registry-hives"><a href="#job-windows-registry-hives" class="header-anchor">#</a> Job <code>windows.registry_hives</code></h3> <p>Extracts an extensive set of keys from Windows Registry hives using regripper. Results are organized according to its information type.</p> <p>This job takes the default configuration of mounted devices as base to locate hive files to parse</p> <h4 id="configurable-parameters-11"><a href="#configurable-parameters-11" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>path</code></td> <td>absolute path to folder containing hives</td> <td>``</td></tr> <tr><td><code>ripplugins</code></td> <td>path to json file containing the organized list of regripper plugins to run</td> <td><code>/home/jvera/Incide/Projects/rvt2/plugins/windows/autorip.json</code></td></tr> <tr><td><code>pluginshives</code></td> <td>path to json file associating each regripper plugin with a list of hives</td> <td><code>/home/jvera/Incide/Projects/rvt2/plugins/windows/regripper_plugins.json</code></td></tr> <tr><td><code>errorfile</code></td> <td>path to log file to register regripper errors</td> <td><code>MORGUE/CASENAME/SOURCE/SOURCE_aux.log</code></td></tr> <tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/hives</code></td></tr> <tr><td><code>volume_id</code></td> <td>volume identifier, such as partition number. Ex: p03</td> <td>``</td></tr> <tr><td><code>casedir</code></td> <td></td> <td><code>MORGUE/CASENAME</code></td></tr></tbody></table> <h3 id="job-windows-amcache"><a href="#job-windows-amcache" class="header-anchor">#</a> Job <code>windows.amcache</code></h3> <p>Parse AmCache hive</p> <h4 id="configurable-parameters-12"><a href="#configurable-parameters-12" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>outdir</code></td> <td>directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/hives</code></td></tr> <tr><td><code>voutdir</code></td> <td>directory where VSS generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/vss/hives</code></td></tr> <tr><td><code>volume_id</code></td> <td>volume identifier, such as partition number. Ex: p03</td> <td>``</td></tr> <tr><td><code>vss</code></td> <td>process Volume Shadow Snapshot</td> <td><code>False</code></td></tr></tbody></table> <h3 id="job-windows-shimcache"><a href="#job-windows-shimcache" class="header-anchor">#</a> Job <code>windows.shimcache</code></h3> <p>Parse ShimCache hive</p> <h4 id="configurable-parameters-13"><a href="#configurable-parameters-13" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>outdir</code></td> <td>directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/hives</code></td></tr> <tr><td><code>voutdir</code></td> <td>directory where VSS generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/vss/hives</code></td></tr> <tr><td><code>volume_id</code></td> <td>volume identifier, such as partition number. Ex: p03</td> <td>``</td></tr> <tr><td><code>vss</code></td> <td>process Volume Shadow Snapshot</td> <td><code>False</code></td></tr></tbody></table> <h3 id="job-windows-syscache"><a href="#job-windows-syscache" class="header-anchor">#</a> Job <code>windows.syscache</code></h3> <p>Parse SysCache hive</p> <h4 id="configurable-parameters-14"><a href="#configurable-parameters-14" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>outdir</code></td> <td>directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/hives</code></td></tr> <tr><td><code>voutdir</code></td> <td>directory where VSS generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/vss/hives</code></td></tr> <tr><td><code>volume_id</code></td> <td>volume identifier, such as partition number. Ex: p03</td> <td>``</td></tr> <tr><td><code>vss</code></td> <td>process Volume Shadow Snapshot</td> <td><code>False</code></td></tr></tbody></table> <h3 id="job-windows-appcompatcache"><a href="#job-windows-appcompatcache" class="header-anchor">#</a> Job <code>windows.appcompatcache</code></h3> <p>Parse AppcompatCache from SYSTEM registry hive
Choose between using regripper or AppCompatCacheParser.exe to parse appcompatcache</p> <ul><li>Regripper ppcompat plugin. Recommended configuration:</li> <li><code>cmd</code>: ``</li> <li>AppCompatCacheParser.exe. Recommended configuration:</li> <li><code>cmd</code>: <code>env WINEDEBUG=fixme-all wine {executable} -f {path} --csv {outdir} --csvf {filename} --nl</code></li></ul> <h4 id="configurable-parameters-15"><a href="#configurable-parameters-15" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>outdir</code></td> <td>directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/execution</code></td></tr> <tr><td><code>voutdir</code></td> <td>directory where VSS generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/vss/execution</code></td></tr> <tr><td><code>volume_id</code></td> <td>volume identifier, such as partition number. Ex: p03</td> <td>``</td></tr> <tr><td><code>cmd</code></td> <td>External command to parse userassist or empty to use internal parser. It is a Python string template accepting variables &quot;executable&quot;, &quot;path&quot;, &quot;outdir&quot; and &quot;filename&quot;. Variable &quot;filename&quot; is automatically set by the job. The rest are the same ones specified in parameters</td> <td>``</td></tr> <tr><td><code>executable</code></td> <td>path to the tool used to parse appcompatcache</td> <td><code>/home/jvera/Incide/Projects/rvt2/external_tools/windows/AppCompatCacheParser.exe</code></td></tr> <tr><td><code>vss</code></td> <td>process Volume Shadow Snapshot</td> <td><code>False</code></td></tr></tbody></table> <h3 id="job-windows-userassist"><a href="#job-windows-userassist" class="header-anchor">#</a> Job <code>windows.userassist</code></h3> <p>Parse userassist key in NTUSER.DAT hive. By default uses RECmd.exe to parse. Windows environment is needed to execute it.</p> <h4 id="configurable-parameters-16"><a href="#configurable-parameters-16" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/hives</code></td></tr> <tr><td><code>volume_id</code></td> <td>volume identifier, such as partition number. Ex: p03</td> <td><code>p01</code></td></tr> <tr><td><code>cmd</code></td> <td>External command to parse userassist. It is a Python string template accepting variables &quot;executable&quot;, &quot;hive&quot;, &quot;outdir&quot;, &quot;filename&quot; and &quot;batch_file&quot;. Variables &quot;hive&quot; and &quot;filename&quot; are automatically set by the job. The rest are the same ones specified in parameters</td> <td><code>env WINEDEBUG=fixme-all wine {executable} --bn {batch_file} -f {hive} --csv {outdir} --csvf {filename} --nl</code></td></tr> <tr><td><code>executable</code></td> <td>path to the tool used to parse userassist</td> <td><code>/home/jvera/Incide/Projects/rvt2/external_tools/windows/RegistryExplorer/RECmd.exe</code></td></tr> <tr><td><code>batch_file</code></td> <td>configuration file for userassist using RECmd.exe</td> <td><code>/home/jvera/Incide/Projects/rvt2/external_tools/windows/RegistryExplorer/BatchExamples/BatchExampleUserAssist.reb</code></td></tr></tbody></table> <h3 id="job-windows-userassist-report"><a href="#job-windows-userassist-report" class="header-anchor">#</a> Job <code>windows.userassist_report</code></h3> <p>Generates a summary file with all userassist files sources.</p> <h4 id="configurable-parameters-17"><a href="#configurable-parameters-17" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>outfile</code></td> <td></td> <td><code>MORGUE/CASENAME/SOURCE/analysis/hives/userassist.csv</code></td></tr> <tr><td><code>path</code></td> <td></td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/hives</code></td></tr></tbody></table> <h3 id="job-windows-shellbags"><a href="#job-windows-shellbags" class="header-anchor">#</a> Job <code>windows.shellbags</code></h3> <p>Parse Shellbags in NTUSER.DAT or usrclass.dat hives. By default uses SBECmd.exe to parse. Windows environment is needed to execute it.</p> <h4 id="configurable-parameters-18"><a href="#configurable-parameters-18" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/hives</code></td></tr> <tr><td><code>volume_id</code></td> <td>volume identifier, such as partition number. Ex: p03</td> <td><code>p01</code></td></tr> <tr><td><code>cmd</code></td> <td>External command to parse shellbags. It is a Python string template accepting variables &quot;executable&quot;, &quot;hives_dir&quot; and &quot;outdir&quot;. Variable &quot;hives_dir&quot; is deduced by the job from &quot;path&quot;. The rest are the same ones specified in parameters</td> <td><code>env WINEDEBUG=fixme-all wine {executable} -d {hives_dir} --csv {outdir} --nl --dedupe</code></td></tr> <tr><td><code>executable</code></td> <td>path to the tool used to parse shellbags</td> <td><code>/home/jvera/Incide/Projects/rvt2/external_tools/windows/ShellBagsExplorer/SBECmd.exe</code></td></tr></tbody></table> <h3 id="job-windows-shellbags-report"><a href="#job-windows-shellbags-report" class="header-anchor">#</a> Job <code>windows.shellbags_report</code></h3> <p>Generates a summary file with all shellbags files sources.</p> <h4 id="configurable-parameters-19"><a href="#configurable-parameters-19" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>outfile</code></td> <td></td> <td><code>MORGUE/CASENAME/SOURCE/analysis/hives/shellbags.csv</code></td></tr> <tr><td><code>path</code></td> <td></td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/hives</code></td></tr></tbody></table> <h3 id="job-windows-registry"><a href="#job-windows-registry" class="header-anchor">#</a> Job <code>windows.registry</code></h3> <p>Dumps Windows Registry hives. Used for indexing purposes.</p> <h4 id="configurable-parameters-20"><a href="#configurable-parameters-20" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>outfile</code></td> <td>path where generated file will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/hives/registry_dump.json</code></td></tr> <tr><td><code>vss</code></td> <td>process Volume Shadow Snapshot</td> <td><code>False</code></td></tr></tbody></table> <h3 id="job-windows-events"><a href="#job-windows-events" class="header-anchor">#</a> Job <code>windows.events</code></h3> <p>Parse Windows event files to get relevant logs events.</p> <p>Type <code>--params path=some_directory</code> to set a custom directory containing the log files to parse.
Individual log files are expected to mantain the same name as Windows conventions.</p> <p>Files parsed:</p> <ul><li>Security</li> <li>System</li> <li>Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational</li> <li>Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational</li> <li>Microsoft-Windows-TerminalServices-RDPClient%4Operational</li> <li>Microsoft-Windows-RemoteDesktopServices-RdpCoreTS%4Operational</li> <li>Microsoft-Windows-TaskScheduler%4Operational</li> <li>Microsoft-Windows-Bits-Client%4Operational</li> <li>Microsoft-Windows-DriverFrameworks-UserMode%4Operational</li> <li>Microsoft-Windows-WLAN-AutoConfig%4Operational</li> <li>OAlerts</li> <li>Microsoft-Windows-User Profile Service%4Operational</li> <li>Microsoft-Windows-Shell-Core%4Operational</li> <li>Microsoft-Windows-Partition%4Diagnostic</li> <li>Microsoft-Windows-Kernel-PnP%4Configuration</li> <li>Microsoft-Windows-Ntfs%4Operational</li> <li>Microsoft-Windows-Storage-ClassPnP%4Operational</li> <li>Micrsoft-Windows-DeviceSetupManager%4Admin</li> <li>Micrsoft-Windows-DeviceSetupManager%4Operational</li></ul> <h4 id="configurable-parameters-21"><a href="#configurable-parameters-21" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>path</code></td> <td>Path to directory containing evtx files</td> <td><code>MORGUE/CASENAME/SOURCE/mnt/p*/[Ww][Ii][Nn][Dd][Oo][Ww][Ss]/[Ss]ystem32/[Ww]inevt/[Ll]ogs</code></td></tr> <tr><td><code>outfile</code></td> <td>path where the generated file will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/events/events.json</code></td></tr></tbody></table> <h3 id="job-windows-eventartifacts"><a href="#job-windows-eventartifacts" class="header-anchor">#</a> Job <code>windows.eventartifacts</code></h3> <p>Extracts Windows artifacts from event files. It is required to execute <code>windows.events</code> before this job
Artifacts extraced:</p> <ul><li>Login, logoff</li> <li>Poweron, poweroff</li> <li>RDP connections</li> <li>Wifi network artifacts</li> <li>Shared objects</li> <li>Winupdate events</li> <li>Scheduled tasks</li> <li>Installed processes and services</li> <li>BITS</li> <li>USB plugs</li> <li>USB install drivers</li> <li>Office Alerts</li></ul> <h4 id="configurable-parameters-22"><a href="#configurable-parameters-22" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>path</code></td> <td>path to json file gnerated by windows.events job</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/events/events.json</code></td></tr> <tr><td><code>outdir</code></td> <td>directory where resulting files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/analysis/events</code></td></tr></tbody></table> <h3 id="job-windows-scheduled-tasks-all"><a href="#job-windows-scheduled-tasks-all" class="header-anchor">#</a> Job <code>windows.scheduled_tasks_all</code></h3> <p>Parse Task Scheduler Service artifacts such as SCHEDLGU.TXT and .job files</p> <h4 id="configurable-parameters-23"><a href="#configurable-parameters-23" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>outdir</code></td> <td>directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/hives</code></td></tr> <tr><td><code>voutdir</code></td> <td>directory where VSS generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/vss/hives</code></td></tr> <tr><td><code>mountdir</code></td> <td></td> <td><code>MORGUE/CASENAME/SOURCE/mnt</code></td></tr> <tr><td><code>vss</code></td> <td>process Volume Shadow Snapshot</td> <td><code>False</code></td></tr></tbody></table> <h3 id="job-windows-scheduled-tasks"><a href="#job-windows-scheduled-tasks" class="header-anchor">#</a> Job <code>windows.scheduled_tasks</code></h3> <p>Parse Task Scheduler Service artifacts such as SCHEDLGU.TXT and .job files
Set the directory to search for such artifacts in <code>path</code></p> <h4 id="configurable-parameters-24"><a href="#configurable-parameters-24" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>outdir</code></td> <td>directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/hives</code></td></tr> <tr><td><code>voutdir</code></td> <td>directory where VSS generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/vss/hives</code></td></tr> <tr><td><code>volume_id</code></td> <td>volume identifier, such as partition number. Ex: p03</td> <td>``</td></tr> <tr><td><code>vss</code></td> <td>process Volume Shadow Snapshot</td> <td><code>False</code></td></tr></tbody></table> <h3 id="job-windows-recycle"><a href="#job-windows-recycle" class="header-anchor">#</a> Job <code>windows.recycle</code></h3> <p>Parse files in (or deleted from) Windows Recycle Bin</p> <h4 id="configurable-parameters-25"><a href="#configurable-parameters-25" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>vss</code></td> <td>process Volume Shadow Snapshot</td> <td><code>False</code></td></tr> <tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/recyclebin</code></td></tr></tbody></table> <h3 id="job-windows-srum"><a href="#job-windows-srum" class="header-anchor">#</a> Job <code>windows.srum</code></h3> <p>Extract and parse SRUM (System Resource Utilization Monitor) from a windows OS</p> <p>SRUM collects statistics on execution of binaries: CPU, memory... It can be used to prove
the execution of a program.</p> <h4 id="configurable-parameters-26"><a href="#configurable-parameters-26" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>vss</code></td> <td>process Volume Shadow Snapshot</td> <td><code>False</code></td></tr> <tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/srum</code></td></tr></tbody></table> <h3 id="job-windows-usb"><a href="#job-windows-usb" class="header-anchor">#</a> Job <code>windows.usb</code></h3> <p>Extracts USB drives data about drivers installation from setupapi.dev.log</p> <h4 id="configurable-parameters-27"><a href="#configurable-parameters-27" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>vss</code></td> <td>process Volume Shadow Snapshot</td> <td><code>False</code></td></tr> <tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/usb</code></td></tr></tbody></table> <h3 id="job-windows-usnjrnl-all"><a href="#job-windows-usnjrnl-all" class="header-anchor">#</a> Job <code>windows.usnjrnl_all</code></h3> <p>Parse all NTFS UsnJrnl files found in an image.
UsnJrnl is the journal log of NTFS. You will find recent oprations on files: deletion, modification, renaming...</p> <h4 id="configurable-parameters-28"><a href="#configurable-parameters-28" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>vss</code></td> <td>process Volume Shadow Snapshot</td> <td><code>False</code></td></tr> <tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/usnjrnl</code></td></tr></tbody></table> <h3 id="job-windows-usnjrnl"><a href="#job-windows-usnjrnl" class="header-anchor">#</a> Job <code>windows.usnjrnl</code></h3> <p>Parse NTFS UsnJrnl, the journal log of NTFS. You will find recent oprations on files: deletion, modification, renaming...</p> <h4 id="configurable-parameters-29"><a href="#configurable-parameters-29" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>vss</code></td> <td>process Volume Shadow Snapshot</td> <td><code>False</code></td></tr> <tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/usnjrnl</code></td></tr> <tr><td><code>volume_id</code></td> <td>volume identifier, such as partition number. Ex: p03</td> <td><code>p01</code></td></tr></tbody></table> <h3 id="job-windows-hiberfil"><a href="#job-windows-hiberfil" class="header-anchor">#</a> Job <code>windows.hiberfil</code></h3> <p>Decompress hiberfil.sys and extract some artifacts</p> <h4 id="configurable-parameters-30"><a href="#configurable-parameters-30" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>vss</code></td> <td>process Volume Shadow Snapshot</td> <td><code>False</code></td></tr> <tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/hibernation</code></td></tr></tbody></table> <h3 id="job-windows-bits"><a href="#job-windows-bits" class="header-anchor">#</a> Job <code>windows.bits</code></h3> <p>Parse Background Intelligent Transfer Service (BITS). This is a service to transfer binaries between systems, used mainly by Microsoft Update and similar programs.</p> <h4 id="configurable-parameters-31"><a href="#configurable-parameters-31" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>path</code></td> <td>path to qmgr0.dat file</td> <td>``</td></tr> <tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/bits</code></td></tr></tbody></table> <h3 id="job-windows-activity-cache"><a href="#job-windows-activity-cache" class="header-anchor">#</a> Job <code>windows.activity_cache</code></h3> <p>Parse ActivitiesCache database.
Provide a globpath to any ActivitiesCache.db as path</p> <h4 id="configurable-parameters-32"><a href="#configurable-parameters-32" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/execution</code></td></tr></tbody></table> <h3 id="job-windows-i30"><a href="#job-windows-i30" class="header-anchor">#</a> Job <code>windows.i30</code></h3> <p>Parse I30 files to obtain a timeline</p> <h4 id="configurable-parameters-33"><a href="#configurable-parameters-33" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>root</code></td> <td>If True, parse also INDX_ROOT attributes.</td> <td><code>False</code></td></tr> <tr><td><code>skip_short</code></td> <td>If True, do not output Windows short format filenames.</td> <td><code>True</code></td></tr> <tr><td><code>only_slack</code></td> <td>If True, parse only the slack space in INDX_ALLOC blocks.</td> <td><code>False</code></td></tr> <tr><td><code>outdir</code></td> <td>path to directory where generated files will be stored</td> <td><code>MORGUE/CASENAME/SOURCE/output/windows/i30</code></td></tr></tbody></table> <h3 id="job-windows-source-summary"><a href="#job-windows-source-summary" class="header-anchor">#</a> Job <code>windows.source_summary</code></h3> <p>Tables summary of previously parsed artefacts</p> <h4 id="configurable-parameters-34"><a href="#configurable-parameters-34" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>outfile</code></td> <td></td> <td><code>MORGUE/CASENAME/SOURCE/analysis/source_summary.md</code></td></tr></tbody></table> <h3 id="job-windows-ir-preforensics"><a href="#job-windows-ir-preforensics" class="header-anchor">#</a> Job <code>windows.IR_preforensics</code></h3> <p>Main set of forensic analysis jobs to run on Windows artifacts. It assumes artifact files are located under <code>MORGUE/CASENAME/SOURCE/mnt</code></p> <p>Artifacts parsed:</p> <ul><li>MFT Timeline</li> <li>Characterize: <code>MORGUE/CASENAME/SOURCE/analysis/disk_summary.md</code></li> <li>Registry: <code>MORGUE/CASENAME/SOURCE/output/windows/hives</code></li> <li>Event Logs:</li> <li><code>MORGUE/CASENAME/SOURCE/output/windows/events</code></li> <li><code>MORGUE/CASENAME/SOURCE/analysis/events</code></li> <li>Lnk and Jumplists:</li> <li><code>MORGUE/CASENAME/SOURCE/output/windows/recentfiles</code></li> <li><code>MORGUE/CASENAME/SOURCE/analysis/recentfiles</code></li> <li>Prefetch: <code>MORGUE/CASENAME/SOURCE/output/windows/execution</code></li> <li>Browser History: <code>MORGUE/CASENAME/SOURCE/output/browsers</code></li></ul> <h4 id="configurable-parameters-35"><a href="#configurable-parameters-35" class="header-anchor">#</a> Configurable parameters</h4> <table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default</th></tr></thead> <tbody><tr><td><code>index_name</code></td> <td>Name of the indice in ElasticSearch</td> <td><code>SOURCE-ecs</code></td></tr> <tr><td><code>events_dir</code></td> <td></td> <td><code>MORGUE/CASENAME/SOURCE/output/events</code></td></tr> <tr><td><code>source</code></td> <td></td> <td><code>SOURCE</code></td></tr></tbody></table> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>This chapter was created automatically using <code>rvt2 -j help windows --params show_vars=&quot;&quot; template_file=&quot;templates/help_section_complete.mako&quot; outfile=&quot;docs/rvt2/windows.md&quot;</code>. Do not modify manually this file.</p></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/IncideDigital/rvt2-docs/edit/master/docs/rvt2/windows.md" target="_blank" rel="noopener noreferrer">Help us to improve this page!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/22/2021, 3:52:42 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/rvt2-docs/rvt2/common.html" class="prev">
        Section common
      </a></span> <span class="next"><a href="/rvt2-docs/rvt2/macos.html">
        Plugin: macos
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/rvt2-docs/assets/js/app.143db98b.js" defer></script><script src="/rvt2-docs/assets/js/2.4edca1ff.js" defer></script><script src="/rvt2-docs/assets/js/28.0185c4b0.js" defer></script>
  </body>
</html>
